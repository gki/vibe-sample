# テスト

このドキュメントには、プロジェクトのテスト方針について記載します。

## テストフレームワーク

- **Vitest**を使用（フロントエンド・バックエンド共通）

## TDDにおけるテストの書き方

### 単体テスト（優先）

- 関数、コンポーネント、リゾルバーの個別テスト
- TDDでは、まず単体テストから始める
- 小さな単位でテストを書く（1つの関数、1つのメソッドなど）

### 統合テスト

- APIエンドポイント、GraphQLクエリ/ミューテーションのテスト
- 単体テストが揃った後に追加で書く

## テストの構造（AAAパターン）

```typescript
describe('関数名またはコンポーネント名', () => {
  it('期待する振る舞いを説明', () => {
    // Arrange（準備）: テストデータやモックの準備
    const input = 'test data';
    
    // Act（実行）: テスト対象の実行
    const result = functionToTest(input);
    
    // Assert（検証）: 結果の検証
    expect(result).toBe(expectedValue);
  });
});
```

## テスト実行

- **開発中**: `pnpm test`（ウォッチモード）- TDDサイクル中は常に実行（詳細は[tdd-process.md](./tdd-process.md)を参照）
- **コミット前**: `pnpm test` - 全テストが通ることを確認
- **カバレッジ確認**: `pnpm test:coverage`

## TDDにおけるテストの原則

1. **テストは明確に**: テスト名は何をテストしているか明確に
2. **1つのテスト、1つのアサーション**: 1つのテストで1つのことを検証
3. **独立性**: テストは互いに依存しない（実行順序に依存しない）
4. **再現性**: 同じ条件下で常に同じ結果になる

## カバレッジ目標

- TDDで実装した部分: 高いカバレッジが自然に達成される
- 初期実装: 60%以上
- 本番リリース前: 80%以上（推奨）

**注意**: カバレッジは目標であり、TDDの目的ではない。TDDの目的は「動作する仕様」を作ること。

